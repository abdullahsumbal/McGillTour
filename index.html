<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Webmap101</title>
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js"></script>
  <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
  <script src='https://npmcdn.com/@turf/turf/turf.min.js'></script>
  <script src="resources\leftlet.ajax.js"></script>
  <script src="resources\leaflet-ant-path.es6.js"></script>
  <!-- integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
  crossorigin="anonymous" -->
<style>
  #header {
    height: 75px;
    background-color: :darkgoldenrod;
  }
  #mapdiv {
    height: 850px;
    background-color: salmon;
  }
  #side_panel{
    height:850px;
    background-color: beige;
  }
  #footer{
    height: 75px;
    background-color: darkgrey;
}
.attraction{
  margin-bottom: 50px;
}
</style>

</head>
<body>
  <div class="container-fluid">
    <div class="row">
      <div id="header" class="col-md-12">
        <h1 class="text-center">Mexico City</h1>
      </div>
  </div>
  <div class="row">
  <div id="side_panel" class="col-md-3 col-sm-3">
    <h1 class="text-center">attraction</h1>
    <button id="btnBuffer" class="form-control btn-warning attraction">Buffer</button>
  </div>
  <div id="mapdiv" class="col-md-9 col-sm-9"></div>
  </div>
  <div class="row">
  <div id="footer" class="col-xl-12">
    <h4 id="map_coords" class="text-center">Latitude : 19.4 Longitude: -99.1 Zoom Level: 11</h4>
    </div>

  </div>
</div>


  <script>
    var mymap = L.map('mapdiv');
    mymap.setView([45.50500, -73.57791] , 17);

    var backgroundLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png');
    mymap.addLayer(backgroundLayer);

    var zocaloMarker = L.marker([19.43278, -99.13333]);
    zocaloMarker.addTo(mymap);
    zocaloMarker.bindPopup("<h3 class='text-center'>Zocolo</h3><hr> <a href='https://en.wikipedia.org/wiki/Z%C3%B3calo' target='blank'> <img src='img/b.png' width='200px' /> </a>");

    // var geojsonLayer = new L.GeoJSON.AJAX("data\/attractions\/attractions.geojson", {pointToLayer: function(feature, latlng){
    var geojsonLayer = new L.GeoJSON.AJAX("myfile.geojson", {pointToLayer: function(feature, latlng){
      var str = "<h4>"+feature.properties.name + "</h4><hr/>";
      str += "<a href='" + feature.properties.web + "' target='blank'>Learn More</a>";

      var buttonStr = "<button id='zoomTo"+feature.properties.name.replace(/ /g, '');
      buttonStr += "' class='form-control btn btn-primary attraction'>";
      buttonStr += feature.properties.name+"</button>";
      if(feature.properties.name.length > 3){
        $("#side_panel").append(buttonStr);
      }


      $("#zoomTo"+feature.properties.name.replace(/ /g, '')).click(function(){
        mymap.setView([latlng.lat, latlng.lng],18);
      });
      return L.marker(latlng).bindPopup(str);
    }});
    geojsonLayer.addTo(mymap);

    var edgeLayer = new L.GeoJSON.AJAX("myfileedges.geojson");
    edgeLayer.addTo(mymap);
    const options = {delay: 400, dashArray: [10,20], weight: 10, color: "#0000FF", pulseColor: "#FFFFFF"};
    const path = new L.Polyline.AntPath([[45.50500, -73.57791],   [45.50249, -73.57643]], options);
    // path.addTo(mymap);
    var bufferLayer;
    $("#btnBuffer").click(function(){
      if ($("#btnBuffer").html() == 'Buffer'){
        var bufferedAttractions = turf.buffer(geojsonLayer.toGeoJSON(), 20, {units: 'meters'});
        bufferLayer = L.geoJSON(bufferedAttractions).addTo(mymap);
        $("#btnBuffer").html("Romve Buffer");
      }else{
        mymap.removeLayer(bufferLayer);
        $("#btnBuffer").html("Buffer");
      }
    });

    mymap.on('mousemove', function(e){
      var str = "Latitude: " + e.latlng.lat.toFixed(5) + " Longitude:" + e.latlng.lng.toFixed(5) + " Zoom Level: " + mymap.getZoom() + e.latlng.lng.toFixed(5) +", "+ e.latlng.lat.toFixed(5);
      $("#map_coords").html(str);
    });
  </script>
</body>
</html>
